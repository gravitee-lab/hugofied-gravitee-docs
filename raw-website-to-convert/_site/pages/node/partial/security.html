<!DOCTYPE html>
<head>
    
<!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Security | Gravitee.io API Platform Documentation</title>
<meta name="generator" content="Jekyll v3.8.7" />
<meta property="og:title" content="Security" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Home page for Gravitee.io API Platform documentation" />
<meta property="og:description" content="Home page for Gravitee.io API Platform documentation" />
<link rel="canonical" href="https://docs.gravitee.io/pages/node/partial/security.html" />
<meta property="og:url" content="https://docs.gravitee.io/pages/node/partial/security.html" />
<meta property="og:site_name" content="Gravitee.io API Platform Documentation" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Security" />
<meta name="twitter:site" content="@graviteeio" />
<script type="application/ld+json">
{"headline":"Security","description":"Home page for Gravitee.io API Platform documentation","url":"https://docs.gravitee.io/pages/node/partial/security.html","@type":"WebPage","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=" ">
<title>Security | Gravitee.io API Platform Documentation</title>
<link rel="stylesheet" href="/css/syntax.css">


<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="/css/modern-business.css">
<link rel="stylesheet" href="/css/lavish-bootstrap.css">
<link rel="stylesheet" href="/css/rouge_github.css">
<link rel="stylesheet" href="/css/customstyles.css">
<link rel="stylesheet" href="/css/theme-bluegrey.css">
<link rel="stylesheet" href="/css/gravitee.css">
<link rel="stylesheet" href="/fonts/plex/css/ibm-plex.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="/js/jquery.navgoco.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="/js/toc.js"></script>
<script src="/js/customscripts.js"></script>

<link rel="shortcut icon" href="/images/favicon.png">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="Gravitee.io API Platform Documentation" href="https://docs.gravitee.iofeed.xml">
<!-- Algolia search -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />


    <script src="/js/init-default.js"></script>

    
</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-lg navbar-brand" href="/index.html"><img alt="Gravitee.io API Platform" src="/images/GRAVITEE_LOGOV2_TRANSPBLEU.png"><span class="projectTitle">Gravitee.io API Platform</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">API Management<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="/apim/3.x/apim_overview_introduction.html">3.x (current)</a></li>
                        
                        
                        
                        <li><a href="/apim/1.x/apim_overview_introduction.html">1.x</a></li>
                        
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Access Management<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="/am/current/am_overview_introduction.html">3.x (current)</a></li>
                        
                        
                        
                        <li><a href="/am/2.x/am_overview_introduction.html">2.x</a></li>
                        
                        
                        
                        <li><a href="/am/1.x/am_overview_introduction.html">1.x</a></li>
                        
                        
                    </ul>
                </li>
                
                

                <!-- entries without drop-downs appear here -->
                
                
                
                <li><a href="/ae/overview_introduction.html">Alert Engine</a></li>
                
                
                
                <li><a href="/cli/cli_introduction.html">CLI</a></li>
                
                
                
                <li><a href="/ee/ee_introduction.html">Enterprise</a></li>
                
                
                
                
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="Search">
                    </div>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
    <div class="col-lg-12">&nbsp;</div>
    <!-- Content Row -->
    <div class="row">
        <!-- Sidebar Column -->
        <div class="col-md-3">

          


<ul id="mysidebar" class="nav">
    <li class="sidebarTitle"> </li>
    
        <!-- if you aren't using the accordion, uncomment this block:
           <p class="external">
               <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
           </p>
           -->
    </li>
</ul>
</div>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

    <!-- Content Column -->
    <div class="col-md-9">
        <div class="post-header">
   <h1 class="post-title-main">Security</h1>
</div>



<div class="post-content">

   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

    


    

  <div class="sect1">
<h2 id="brute_force_attack">Brute Force attack</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It consists of submitting lots authentication requests based on many passwords expecting one guessing right.
More details on : <a href="https://en.wikipedia.org/wiki/Brute-force_attack" class="bare">https://en.wikipedia.org/wiki/Brute-force_attack</a>.
Even with oauth2 activated you can leave login form for in-memory or local users. Some tools can help you to prevent malicious actions by banning IP.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="fail2ban">Fail2Ban</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this part we explain you how to secure APIM UI and REST API against brute force attack.
To install fail2ban follow Official fail2ban website : <a href="https://www.fail2ban.org" class="bare">https://www.fail2ban.org</a></p>
</div>
<div class="sect2">
<h3 id="configuration">Configuration</h3>
<div class="paragraph">
<p>Gravitee.io API REST trace all authentication failure into gravitee log file.
Firstly you have to configure fail2ban filter to extract Gravitee authentication failure event.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell">2019-05-03 16:03:03.304 <span class="o">[</span>gravitee-listener-31] WARN  i.g.m.s.l.AuthenticationFailureListener - Authentication failed event <span class="k">for</span> : admin - IP : 10.50.24.18</code></pre>
</div>
</div>
<div class="paragraph">
<p>Add a conf file to declare filter : /etc/fail2ban/filter.d/gravitee.conf</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ini"><span class="nn">[Definition]</span>
<span class="py">failregex</span> <span class="p">=</span> <span class="s">.*Authentication failed event for.*IP : &lt;HOST&gt;</span>
<span class="py">ignoreregex</span> <span class="p">=</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now you have to provide actions to fail2ban in  /etc/fail2ban/action.d/gravitee.conf.
Action are iptables or firewalld commands.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ini"><span class="nn">[INCLUDES]</span>

<span class="py">before</span> <span class="p">=</span> <span class="s">iptables-common.conf</span>

<span class="nn">[Definition]</span>

<span class="c"># Option:  actionstart
# Notes.:  command executed once at the start of Fail2Ban.
# Values:  CMD
#
</span><span class="py">actionstart</span> <span class="p">=</span> <span class="s">&lt;iptables&gt; -N f2b-&lt;name&gt;</span>
              <span class="err">&lt;iptables&gt;</span> <span class="err">-A</span> <span class="err">f2b-&lt;name&gt;</span> <span class="err">-j</span> <span class="err">&lt;returntype&gt;</span>
              <span class="err">&lt;iptables&gt;</span> <span class="err">-I</span> <span class="err">&lt;chain&gt;</span> <span class="err">-p</span> <span class="err">&lt;protocol&gt;</span> <span class="err">--dport</span> <span class="err">&lt;port&gt;</span> <span class="err">-j</span> <span class="err">f2b-&lt;name&gt;</span>

<span class="c"># Option:  actionstop
# Notes.:  command executed once at the end of Fail2Ban
# Values:  CMD
#
</span><span class="py">actionstop</span> <span class="p">=</span> <span class="s">&lt;iptables&gt; -D &lt;chain&gt; -p &lt;protocol&gt; --dport &lt;port&gt; -j f2b-&lt;name&gt;</span>
             <span class="err">&lt;iptables&gt;</span> <span class="err">-F</span> <span class="err">f2b-&lt;name&gt;</span>
             <span class="err">&lt;iptables&gt;</span> <span class="err">-X</span> <span class="err">f2b-&lt;name&gt;</span>

<span class="c"># Option:  actioncheck
# Notes.:  command executed once before each actionban command
# Values:  CMD
#
</span><span class="py">actioncheck</span> <span class="p">=</span> <span class="s">&lt;iptables&gt; -n -L &lt;chain&gt; | grep -q 'f2b-&lt;name&gt;[ </span><span class="se">\t</span><span class="s">]'</span>

<span class="c"># Option:  actionban
# Notes.:  command executed when banning an IP. Take care that the
#          command is executed with Fail2Ban user rights.
# Tags:    See jail.conf(5) man page
# Values:  CMD
#
</span><span class="py">actionban</span> <span class="p">=</span> <span class="s">&lt;iptables&gt; -I f2b-&lt;name&gt; 1 -p tcp -m string --algo bm --string 'X-Forwarded-For: &lt;ip&gt;' -j DROP</span>

<span class="c"># Option:  actionunban
# Notes.:  command executed when unbanning an IP. Take care that the
#          command is executed with Fail2Ban user rights.
# Tags:    See jail.conf(5) man page
# Values:  CMD
#
</span><span class="py">actionunban</span> <span class="p">=</span> <span class="s">&lt;iptables&gt; -D f2b-&lt;name&gt; -p tcp -m string --algo bm --string 'X-Forwarded-For: &lt;ip&gt;' -j DROP</span>

<span class="nn">[Init]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally juste declare the new Gravitee Fail2ban block in the main configuration file.
Up to you to provide right parameters. Each time you modify fail2ban configuration resources you have to restart the service.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ini"><span class="nn">[gravitee]</span>
<span class="py">banaction</span> <span class="p">=</span> <span class="s">gravitee</span>
<span class="py">logpath</span> <span class="p">=</span> <span class="s">/opt/gravitee-io-management-api/logs/management_api.log</span>
<span class="py">filter</span> <span class="p">=</span> <span class="s">gravitee</span>
<span class="py">enabled</span> <span class="p">=</span> <span class="s">true</span>
<span class="py">maxretry</span> <span class="p">=</span> <span class="s">3</span></code></pre>
</div>
</div>
</div>
</div>
</div>

    <div class="tags">
        
    </div>

    

</div>

<hr class="shaded"/>

<footer class="footer">
    <div class="newsletter-box">
        <div class="newsletter-title">Join the community</div>
        <p>Subscribe to get product updates in your inbox</p>
        <form id="newsletter-form" class="newsletter-form">
            <input required name="email" type="email" class="gv-input" placeholder="Email Address">
            <button type="submit" class="gv-button">Subscribe</button>
        </form>
        <span class="message">We won’t send you spam, unsubscribe at any time</span>

        <span class="newsletter-error">
            <i class="fa fa-exclamation"></i>
            <span></span>
        </span>
        <span class="newsletter-success">
            <i class="fa fa-check"></i>
            <span></span>
        </span>
    </div>
    <div class="footer-information">
        <div class="footer-links">
            <a title="Github" href="https://github.com/gravitee-io" target="_blank"><i
                    class="fa fa-github fa-3x"></i></a>
            <a title="Twitter" href="https://twitter.com/graviteeio" target="_blank"><i class="fa fa-twitter fa-3x"></i></a>
            <a title="Linkedin" href="https://www.linkedin.com/company/gravitee-io" target="_blank"><i
                    class="fa fa-linkedin fa-3x"></i></a>
        </div>
        <div>
            &copy;2020 GraviteeSource. All rights reserved. <br/>
            Gravitee.io API Platform is distributed under <a href="http://www.apache.org/licenses/LICENSE-2.0.html">Apache
            License V2</a><br/>
             Site last
            generated: Dec 6, 2020
        </div>
    </div>
</footer>

<!-- Algolia search -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script>
<script type="text/javascript"> docsearch({
  apiKey: 'b1c2f572a3911c288af513bd3e7d87f4',
  indexName: 'gravitee',
  inputSelector: '#search-input',
  debug: false // Set debug to true if you want to inspect the dropdown
});

$(document).ready(function () {
  $('#newsletter-form').on('submit', function (event) {
    var formData = $(this).serializeArray();
    $.ajax({
      type: 'POST',
      url: 'https://newsletter.gravitee.io/',
      dataType: 'json',
      data: JSON.stringify({ email: formData[0].value }),
      contentType: 'application/json; charset=utf-8',
      cache: false,
      headers: {
        'Accept': 'application/json',
        'Content-Type': 'application/json'
      },
      statusCode: {
        201: function () {
          $('.newsletter-error').hide();
          $('.newsletter-success span')[0].innerText = 'Your subscription has been sent.';
          $('.newsletter-success').show();
        },
        400: function () {
          $('.newsletter-error').hide();
          $('.newsletter-success span')[0].innerText = 'You have already subscribe to the newsletter.';
          $('.newsletter-success').show();
        },
        500: function () {
          $('.newsletter-error span')[0].innerText = 'Sorry, an error occurred. Please try again later.';
          $('.newsletter-success').hide();
          $('.newsletter-error').show();
        }
      },
      complete: function () {
        $('.message').hide();
      }
    });
    event.preventDefault();
    event.stopPropagation();
  });
});

</script>

<!-- Start of HubSpot Embed Code -->
<script type="text/javascript" id="hs-script-loader" async defer src="//js.hs-scripts.com/7600448.js"></script>
<!-- End of HubSpot Embed Code -->

    </div>
    <!-- /.row -->
</div>
<!-- /.container -->
    </div>

</body>

<!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-67690250-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>


</html>
